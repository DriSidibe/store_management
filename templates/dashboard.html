{% extends 'base.html' %}

{% block content %}
    <div class="content form-wrapper container-fluid">
    <h2>Produits en Stock</h2>
    <form action="/" method="POST">
        {% csrf_token %}
        <div class="form-row">
            <div class="form-group col-12 col-md-4">
                <input type="search" name="product_id" id="product_id" class="form-control form-control-sm" placeholder="Entrer l'ID du produit">
            </div>
            <div class="form-group col-12 col-md-4">
                <input type="search" name="prod_name" id="product_name" class="form-control form-control-sm" placeholder="Entrer le nom du produit">
            </div>
            <div class="form-group col-12 col-md-4">
                <input type="submit" value="Rechercher" class="btn btn-primary btn-block">
            </div>
        </div>
    </form>
    <div class="table-responsive">
        <table id="dash-table" class="table"> 
            <thead class="thead-dark"> 
                <tr> 
                    <th scope="col">ID</th> 
                    <th scope="col">Nom</th> 
                    <th scope="col">Quantit√©</th> 
                    <th scope="col">Prix</th> 
                    <th scope="col">Image</th> 
                    {% if request.user.username == 'drissa' %}
                    <th scope="col">Actions</th> 
                    {% endif %}
                </tr> 
            </thead> 
            <tbody> 
                {% for product in products %} 
                <tr> 
                    <th scope="row">{{product.product_id}}</th> 
                    <td>{{product.product_name}}</td> 
                    <td>{{product.product_quantity}}</td> 
                    <td>{{product.product_sp|floatformat:2}}</td> 
                    <td><img style="width: 50px; height: 50px;" src="{{product.product_image.url}}"/></td> 
                    {% if request.user.username == 'drissa' %}
                    <td>
                        <div>
                            <form action="/search-product/" method="GET">
                                {% csrf_token %}
                                <input name="product_id" style="display: none;" value="{{product.product_id}}"/>
                                <input type="submit" class="btn btn-warning" value="modifier"/>
                            </form>
                            <form action="/delete-product/" method="GET">
                                {% csrf_token %}
                                <input name="product_id" style="display: none;" value="{{product.product_id}}"/>
                                <input type="submit" class="btn btn-danger" value="supprimer"/>
                            </form>
                        </div>
                    </td> 
                    {% endif %}
                </tr> 
                {% endfor %} 
            </tbody> 
        </table>
        <div id="mobile">
            {% for product in products %}
                <div class="card">
                    <div class="card-image">
                        <img src="{{product.product_image.url}}" alt="{{product.product_name}}">
                    </div>
                    <div class="card-details">
                        <div class="detail-item">
                            <h5>Code:</h5>
                            <p>{{product.product_id}}</p>
                        </div>
                        <div class="detail-item">
                            <h5>Nom:</h5>
                            <p>{{product.product_name}}</p>
                        </div>
                        <div class="detail-item">
                            <h5>Prix:</h5>
                            <p>{{product.product_sp|floatformat:2}}</p>
                        </div>
                        <div class="detail-item">
                            <h5>Qte rest:</h5>
                            <p>{{product.product_quantity}}</p>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}
